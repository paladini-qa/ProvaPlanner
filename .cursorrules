# Cursor Rules para ProvaPlanner

## Estrutura do Projeto - Clean Architecture

Este projeto segue os princípios da Clean Architecture com as seguintes camadas:

### Domain Layer (`lib/domain/`)
- **Entities**: `lib/domain/entities/` - Entidades de domínio puras (sem dependências do Flutter)
- **Repositories**: `lib/domain/repositories/` - Interfaces abstratas de repositórios
- **Use Cases**: `lib/domain/usecases/` - Casos de uso da aplicação

### Data Layer (`lib/data/`)
- **Data Sources**: `lib/data/datasources/` - Fontes de dados (local, remoto)
- **Models (DTOs)**: `lib/data/models/` - Data Transfer Objects para serialização
- **Mappers**: `lib/data/mappers/` - Conversores entre Entity e DTO
- **Repositories**: `lib/data/repositories/` - Implementações concretas dos repositórios

### Presentation Layer (`lib/presentation/`)
- **Extensions**: `lib/presentation/extensions/` - Extensões para entidades (lógica de UI)
- **Services**: `lib/presentation/services/` - Serviços de apresentação (wrappers)

### Estrutura Antiga (ainda existente para alguns modelos)
- **Models**: `lib/models/` - Alguns modelos ainda não migrados
  - Entities: `lib/models/entities/`
  - DTOs: `lib/models/dtos/`
  - Mappers: `lib/models/mappers/`

## Regras de Import

### Para testes:
- **IMPORTANTE**: Em Dart, imports de pacote NÃO devem incluir `/lib` no caminho
- Use: `package:prova_planner/models/...` (correto)
- NÃO use: `package:prova_planner/lib/models/...` (incorreto)
- Para modelos antigos: `package:prova_planner/models/...`
- Para nova estrutura: `package:prova_planner/domain/...` ou `package:prova_planner/data/...`

### Ao corrigir imports quebrados:
1. Verifique primeiro se o arquivo existe na estrutura antiga (`lib/models/`)
2. Se não existir, verifique na nova estrutura (`lib/domain/` ou `lib/data/`)
3. Atualize os imports nos testes para apontar para o caminho correto

## Correção Automática de Problemas

Quando encontrar erros de import:
1. Verifique a estrutura atual do projeto
2. Corrija os imports para apontar para os caminhos corretos
3. Se os arquivos foram movidos para Clean Architecture, atualize os imports nos testes

## Convenções

- **Entities**: Sempre no `domain/entities/` (nova estrutura) ou `models/entities/` (antiga)
- **DTOs**: Sempre no `data/models/` (nova estrutura) ou `models/dtos/` (antiga)
- **Mappers**: Sempre no `data/mappers/` (nova estrutura) ou `models/mappers/` (antiga)
- **Repositories**: Interfaces no `domain/repositories/`, implementações no `data/repositories/`

## Exemplo de Correção

Se um teste tem:
```dart
import 'package:prova_planner/lib/models/dtos/aluno_dto.dart';  // ERRADO - tem /lib
```

Corrija para:
```dart
import 'package:prova_planner/models/dtos/aluno_dto.dart';  // CORRETO - sem /lib
```

Se o arquivo foi movido para Clean Architecture (`lib/data/models/aluno_dto.dart`), atualize para:
```dart
import 'package:prova_planner/data/models/aluno_dto.dart';  // CORRETO - sem /lib
```

## Regra Geral de Imports

**SEMPRE remova `/lib` dos imports de pacote em Dart!**
- O Dart automaticamente resolve o diretório `lib/`
- Caminho do arquivo: `lib/models/aluno.dart`
- Import correto: `package:prova_planner/models/aluno.dart`
- Import errado: `package:prova_planner/lib/models/aluno.dart`

## Verificação de Lint e Problemas

### Regras Obrigatórias

**SEMPRE verifique e corrija erros de lint ao fazer alterações:**
1. **Antes de finalizar qualquer alteração**, execute verificação de lint nos arquivos modificados
2. **Corrija todos os avisos de lint** antes de considerar a tarefa completa
3. **Use `const` sempre que possível** para melhorar performance:
   - `const Text()` em vez de `Text()`
   - `const TextStyle()` em vez de `TextStyle()`
   - `const []` para listas imutáveis
   - `const {}` para sets imutáveis
4. **Prefira `final` sobre `var`** para variáveis que não serão reatribuídas
5. **Organize imports** automaticamente ao salvar

### Regras de Lint Prioritárias

Sempre verifique e corrija:
- `prefer_const_constructors` - Use const em construtores
- `prefer_const_literals_to_create_immutables` - Use const em literais imutáveis
- `prefer_final_fields` - Use final em campos
- `prefer_final_locals` - Use final em variáveis locais
- `avoid_print` - Não use print(), use debugPrint() ou logging apropriado
- `use_build_context_synchronously` - Não use BuildContext após operações assíncronas
- `sized_box_for_whitespace` - Use SizedBox em vez de Container vazio
- `use_key_in_widget_constructors` - Adicione keys quando necessário

### Processo de Verificação

Ao fazer alterações:
1. **Durante a edição**: O Cursor verifica automaticamente em tempo real
2. **Ao salvar**: Correções automáticas são aplicadas (format, organize imports, fix all)
3. **Antes de finalizar**: Execute `read_lints` nos arquivos modificados
4. **Se houver erros**: Corrija todos antes de considerar completo

### Comandos Úteis

- Use `read_lints` para verificar erros de lint
- Use `flutter analyze` para análise completa do projeto
- Use `dart format .` para formatar todo o código

### Exceções

Apenas ignore regras de lint se:
- For explicitamente necessário para funcionalidade específica
- Adicione comentário explicando o motivo: `// ignore: nome_da_regra`
- Prefira `// ignore_for_file` apenas quando realmente necessário para todo o arquivo

